<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Calendar View cho lịch chấm công nhân viên -->
    <record id="view_attendance_calendar_manager" model="ir.ui.view">
        <field name="name">attendance.calendar.manager</field>
        <field name="model">hr.attendance</field>
        <field name="arch" type="xml">
            <calendar string="Lịch chấm công nhân viên" 
                     date_start="check_in"
                     color="employee_id"
                     mode="month">
                <field name="employee_id"/>
                <field name="check_in"/>
                <field name="check_out"/>
                <field name="worked_hours"/>
                <field name="attendance_type_id"/>
                <field name="state"/>
                <field name="is_late"/>
                <field name="is_early"/>
            </calendar>
        </field>
    </record>

    <!-- Kanban View tổng quan nhân viên -->
    <record id="view_employee_kanban_manager" model="ir.ui.view">
        <field name="name">employee.kanban.manager</field>
        <field name="model">hr.employee</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile">
                <field name="name"/>
                <field name="department_id"/>
                <field name="resource_calendar_id"/>
                <field name="attendance_count"/>
                
                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_global_click">
                            <div class="oe_kanban_details">
                                <strong><field name="name"/></strong>
                                <div>
                                    <i class="fa fa-building-o"/> <field name="department_id"/>
                                </div>
                                <div>
                                    <i class="fa fa-clock-o"/> <field name="resource_calendar_id"/>
                                </div>
                                <div>
                                    <i class="fa fa-calendar"/> Số lần chấm công: <field name="attendance_count"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Search View cho chấm công -->
    <record id="view_attendance_search_calendar" model="ir.ui.view">
        <field name="name">attendance.search.calendar</field>
        <field name="model">hr.attendance</field>
        <field name="arch" type="xml">
            <search>
                <field name="employee_id"/>
                <field name="check_in"/>
                <field name="attendance_type_id"/>
                
                <filter string="Tháng này" name="this_month" 
                        domain="[('check_in', '&gt;=', (context_today + relativedelta(day=1)).strftime('%Y-%m-%d')), 
                                ('check_in', '&lt;', (context_today + relativedelta(day=31)).strftime('%Y-%m-%d'))]"/>
                <filter string="Tuần này" name="this_week" 
                        domain="[('check_in', '&gt;=', (context_today - relativedelta(days=context_today.weekday())).strftime('%Y-%m-%d')),
                                ('check_in', '&lt;', (context_today + relativedelta(days=7-context_today.weekday())).strftime('%Y-%m-%d'))]"/>
                <filter string="Hôm nay" name="today" 
                        domain="[('check_in', '&gt;=', context_today.strftime('%Y-%m-%d')),
                                ('check_in', '&lt;', (context_today + relativedelta(days=1)).strftime('%Y-%m-%d'))]"/>
                <filter string="Đã duyệt" name="validated" 
                        domain="[('state', '=', 'validated')]"/>
                <filter string="Chờ duyệt" name="pending" 
                        domain="[('state', '=', 'confirmed')]"/>
                
                <group expand="0" string="Nhóm theo">
                    <filter string="Nhân viên" name="group_employee" 
                            context="{'group_by': 'employee_id'}"/>
                    <filter string="Loại công" name="group_type" 
                            context="{'group_by': 'attendance_type_id'}"/>
                    <filter string="Trạng thái" name="group_state" 
                            context="{'group_by': 'state'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Search View cho nhân viên -->
    <record id="view_employee_search_manager" model="ir.ui.view">
        <field name="name">employee.search.manager</field>
        <field name="model">hr.employee</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="department_id"/>
                <field name="resource_calendar_id"/>
                
                <filter string="Đội của tôi" name="my_team" 
                        domain="[('parent_id', '=', uid)]"/>
                <filter string="Đang hoạt động" name="active" 
                        domain="[('active', '=', True)]"/>
                <filter string="Có chấm công hôm nay" name="has_attendance_today" 
                        domain="[('attendance_ids', '!=', False)]"/>
                
                <group expand="0" string="Nhóm theo">
                    <filter string="Phòng ban" name="group_department" 
                            context="{'group_by': 'department_id'}"/>
                    <filter string="Lịch làm việc" name="group_calendar" 
                            context="{'group_by': 'resource_calendar_id'}"/>
                </group>
            </search>
        </field>
    </record>
</odoo>