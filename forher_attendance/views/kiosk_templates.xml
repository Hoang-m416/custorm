<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>

    <template id="kiosk_form" name="Forher Kiosk">
      <t t-call="web.layout">
        <t t-call-assets="forher_attendance.assets_kiosk"/>
        <div class="o_container" style="max-width:560px;margin:auto;padding:32px;">
          <div class="fk-card">
            <h2 class="fk-title">Ch·∫•m c√¥ng (Kiosk)</h2>
            <div class="fk-branch-name" style="text-align:center;margin-bottom:16px;color:#9fb0d6;font-size:14px;">
              <i class="fa fa-building-o"></i> <t t-esc="kiosk_company_name or 'Chi nh√°nh'"/>
            </div>

            <t t-if="error">
              <div class="alert alert-danger" role="alert">
                <i class="fa fa-exclamation-triangle"></i>
                <t t-esc="error"/>
              </div>
            </t>

            <form id="fk-form" action="/forher_attendance/kiosk/punch" method="post" class="o_form">

              <!-- Ch·ªçn nh√¢n vi√™n -->
              <div class="form-group fk-field">
                <label class="fk-label">Ch·ªçn nh√¢n vi√™n</label>
                <select name="employee_id" class="form-control fk-select">
                  <option value="">-- Kh√¥ng ch·ªçn (d√πng PIN/M√£) --</option>
                  <t t-foreach="employees or []" t-as="emp">
                    <option t-att-value="emp.id">
                      <t t-esc="emp.name"/><t t-if="emp.employee_code"> [<t t-esc="emp.employee_code"/>]</t>
                    </option>
                  </t>
                </select>
                <div class="fk-hint">N·∫øu ch·ªçn nh√¢n vi√™n, b·∫°n ph·∫£i nh·∫≠p ƒë√∫ng PIN c·ªßa nh√¢n vi√™n ƒë√≥.</div>
              </div>

              <!-- PIN + Keypad -->
              <div class="fk-pin-wrap fk-field">
                <label class="fk-label">PIN</label>

                <div class="fk-pin-input">
                  <input id="fk-pin" type="password" name="pin" class="form-control"
                         placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" inputmode="numeric" pattern="[0-9]*" autocomplete="one-time-code"/>
                  <button class="fk-eye" type="button" title="Hi·ªán/·∫©n PIN" aria-label="Hi·ªán ho·∫∑c ·∫©n PIN">
                    <span class="fk-eye-icon">üëÅÔ∏è</span>
                  </button>
                </div>

                <div class="fk-keypad" id="fk-keypad">
                  <button type="button" class="fk-key" data-key="1">1</button>
                  <button type="button" class="fk-key" data-key="2">2</button>
                  <button type="button" class="fk-key" data-key="3">3</button>

                  <button type="button" class="fk-key" data-key="4">4</button>
                  <button type="button" class="fk-key" data-key="5">5</button>
                  <button type="button" class="fk-key" data-key="6">6</button>

                  <button type="button" class="fk-key" data-key="7">7</button>
                  <button type="button" class="fk-key" data-key="8">8</button>
                  <button type="button" class="fk-key" data-key="9">9</button>

                  <button type="button" class="fk-key fk-key-func" data-key="del">‚å´</button>
                  <button type="button" class="fk-key" data-key="0">0</button>
                  <button type="button" class="fk-key fk-key-func" data-key="clr">C</button>
                </div>
              </div>

              <div class="fk-sep">‚Äî ho·∫∑c ‚Äî</div>

              <!-- M√£ NV / Barcode -->
              <div class="form-group fk-field">
                <label class="fk-label">M√£ nh√¢n vi√™n / Barcode</label>
                <input type="text" name="code" class="form-control" placeholder="Nh·∫≠p m√£ NV ho·∫∑c qu√©t m√£"/>
              </div>

              <input type="hidden" name="token"
                     t-att-value="request.env['ir.config_parameter'].sudo().get_param('forher_attendance.kiosk_token', '')"/>

              <button type="submit" class="btn btn-primary btn-block fk-submit">
                <i class="fa fa-clock-o"></i> Ch·∫•m c√¥ng
              </button>
            </form>
          </div>
        </div>
      </t>
    </template>

    <!-- Template hi·ªÉn th·ªã k·∫øt qu·∫£ th√†nh c√¥ng -->
    <template id="kiosk_success" name="Kiosk Success">
      <t t-call="web.layout">
        <t t-call-assets="forher_attendance.assets_kiosk"/>
        <div class="o_container" style="max-width:560px;margin:auto;padding:32px;">
          <div class="fk-card text-center">
            <h2 class="fk-title">
              <i class="fa fa-check-circle" style="color:#28a745;margin-right:8px;"/>
              Ch·∫•m c√¥ng th√†nh c√¥ng!
            </h2>
            
            <div style="margin:24px 0;">
              <div style="font-size:18px;margin-bottom:12px;">
                <strong><t t-esc="employee.name"/></strong>
              </div>
              
              <div style="font-size:16px;color:#9fb0d6;margin-bottom:8px;">
                <t t-if="action == 'checkin'">
                  <i class="fa fa-sign-in" style="color:#28a745;"/> ƒê√£ check-in
                </t>
                <t t-else="">
                  <i class="fa fa-sign-out" style="color:#ffc107;"/> ƒê√£ check-out  
                </t>
              </div>
              
              <div style="font-size:14px;color:#9fb0d6;">
                Th·ªùi gian: <t t-esc="datetime.datetime.now().strftime('%H:%M:%S - %d/%m/%Y')"/>
              </div>
              
              <t t-if="location">
                <div style="font-size:12px;color:#9fb0d6;margin-top:8px;">
                  ƒê·ªãa ƒëi·ªÉm: <t t-esc="location"/>
                </div>
              </t>
            </div>

            <a href="/forher_attendance/kiosk" class="btn btn-primary fk-submit">
              <i class="fa fa-refresh"/> Ch·∫•m c√¥ng ti·∫øp
            </a>
          </div>
        </div>
      </t>
    </template>

    <!-- Template hi·ªÉn th·ªã khi b·ªã ch·∫∑n -->
    <template id="kiosk_blocked" name="Kiosk Blocked">
      <t t-call="web.layout">
        <t t-call-assets="forher_attendance.assets_kiosk"/>
        <div class="o_container" style="max-width:560px;margin:auto;padding:32px;">
          <div class="fk-card text-center">
            <h2 class="fk-title">
              <i class="fa fa-exclamation-triangle" style="color:#dc3545;margin-right:8px;"/>
              Truy c·∫≠p b·ªã t·ª´ ch·ªëi
            </h2>
            
            <div style="margin:24px 0;">
              <div class="alert alert-danger" style="border-radius:12px;">
                <t t-esc="reason"/>
              </div>
            </div>

            <div class="fk-footnote">
              Li√™n h·ªá qu·∫£n tr·ªã vi√™n ƒë·ªÉ ƒë∆∞·ª£c c·∫•p quy·ªÅn truy c·∫≠p.
            </div>
          </div>
        </div>
      </t>
    </template>

  </data>
</odoo>
