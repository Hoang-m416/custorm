<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- ================= LIST VIEW ================= -->
    <record id="view_attendance_list_inherit" model="ir.ui.view">
        <field name="name">hr.attendance.list.forher</field>
        <field name="model">hr.attendance</field>
        <field name="inherit_id" ref="hr_attendance.view_attendance_tree"/>
        <field name="arch" type="xml">
            <field name="employee_id" position="after">
                <field name="branch_id"/>
                <field name="parent_company_id"/>
                <field name="contract_type_id"/>
            </field>
            <field name="worked_hours" position="after">
                <field name="attendance_type_id"/>
                <field name="quantity"/>
                <field name="total_amount"/>
                <field name="recorded_by"/>
                <field name="is_public"/>
                <field name="is_late"/>
                <field name="is_early"/>
                <field name="state" widget="badge"
                       decoration-success="state == 'validated'"
                       decoration-warning="state == 'confirmed'"
                       decoration-danger="state == 'rejected'"
                       decoration-muted="state == 'draft'"/>
            </field>
        </field>
    </record>

     <record id="view_attendance_form_inherit" model="ir.ui.view">
        <field name="name">hr.attendance.form.forher</field>
        <field name="model">hr.attendance</field>
        <field name="inherit_id" ref="hr_attendance.hr_attendance_view_form"/>
        <field name="arch" type="xml">
            <!-- Khóa các field cơ bản -->
            <xpath expr="//field[@name='employee_id']" position="after">
                <field name="branch_id" readonly="1"/>
                <field name="parent_company_id" readonly="1"/>
                <field name="contract_type_id" readonly="1"/>
                <field name="date" readonly="1"/>
            </xpath>

            <!-- Thêm nhóm Công & Loại công và Người ghi nhận -->
        <xpath expr="//sheet/group[1]" position="after">
            <group string="Công &amp; Loại công">
                <field name="attendance_type_id"/>
                <field name="quantity"/>
                <field name="total_amount"/>
                <field name="is_late"/>
                <field name="is_early"/>
            </group>
            <group string="Người ghi nhận">
                <field name="recorded_by"/>
                <field name="is_public"/>
            </group>
        </xpath>

        </field>
    </record>

    <!-- ================= SEARCH VIEW ================= -->
    <record id="view_attendance_search_forher" model="ir.ui.view">
        <field name="name">hr.attendance.search.forher</field>
        <field name="model">hr.attendance</field>
        <field name="arch" type="xml">
            <search string="Tìm kiếm Chấm công">
                <field name="employee_id"/>
                <field name="branch_id"/>
                <field name="parent_company_id"/>
                <field name="attendance_type_id"/>
                <field name="date"/>
                <filter name="pending_validation" string="Chờ duyệt" domain="[('state', '=', 'confirmed')]"/>
                <filter name="validated" string="Đã duyệt" domain="[('state', '=', 'validated')]"/>
                <filter name="draft" string="Nháp" domain="[('state', '=', 'draft')]"/>
                <filter name="rejected" string="Từ chối" domain="[('state', '=', 'rejected')]"/>
                <group expand="1" string="Nhóm theo">
                    <filter name="groupby_employee" string="Nhân viên" context="{'group_by': 'employee_id'}"/>
                    <filter name="groupby_state" string="Trạng thái" context="{'group_by': 'state'}"/>
                    <filter name="groupby_branch" string="Chi nhánh" context="{'group_by': 'branch_id'}"/>
                    <filter name="groupby_attendance_type" string="Loại công" context="{'group_by': 'attendance_type_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- ================= ACTION ================= -->
    <record id="hr_attendance_action" model="ir.actions.act_window">
        <field name="name">Chấm công</field>
        <field name="res_model">hr.attendance</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="view_attendance_search_forher"/>
    </record>

</odoo>
